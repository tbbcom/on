/*! Blogger Sitemap (whitelist + pagination) | tbbcom/on */
(function(){"use strict";const e=Object.assign({perPage:24,pagination:"numbers",labelNavLimit:20,excerptLength:160,thumbWidth:480,fallbackThumb:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="640" height="360" viewBox="0 0 640 360"%3E%3Crect width="640" height="360" fill="%23f0f0f0"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999" font-family="sans-serif" font-size="18"%3ENo Image%3C/text%3E%3C/svg%3E',labelsWanted:[],showAllButton:!0},window.SitemapConfig||{}),t={mode:"recent",label:null,page:1,total:0,items:[],labels:[],labelTotals:new Map,loading:!1},n=document.getElementById("recentpostnavfeed"),a=document.getElementById("recentpostsae");if(!n||!a)return;const s=new Map;function i(e,t){const n="__smap_cb_"+Math.random().toString(36).slice(2),a=document.createElement("script"),s=e.includes("?")?"&":"?";a.src=e+(e.includes("alt=json-in-script")?"":s+"alt=json-in-script")+"&callback="+n,a.async=!0;const i=(e,t)=>{try{delete window[n]}catch(e){}try{a.remove()}catch(e){}t?c(t):c(null)},c=(e=>t(e));window[n]=e=>i(null,e),a.onerror=(()=>i(new Error("Feed load error"))),document.head.appendChild(a),setTimeout((()=>{window[n]&&i(new Error("Timeout"))}),15e3)}function l(e){return"/feeds/posts/summary/-/"+encodeURIComponent(e)}function o(){return"/feeds/posts/summary"}function r(t){return(t-1)*e.perPage+1}function d(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(e).replace(/[&<>"'/]/g,(e=>t[e]))}function p(e){if(!e)return"";const t=["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogos","Sep","Okt","Nov","Dis"];return e.getDate()+" "+t[e.getMonth()]+" "+e.getFullYear()}function u(e){const t=(e||"").toLowerCase(),n={resepi:"🍔",travel:"✈️",teknologi:"💻",komputer:"🖥️",birthday:"🎉",islamik:"🕌",islam:"🕋",kurier:"🚚",review:"⭐",kesihatan:"💪",direktori:"📌",pendidikan:"📚",berita:"📰",hiburan:"🎬",lokasi:"📍",masakan:"🍳",tutorial:"💡","bantuan kewangan":"💰","bantuan kerajaan":"🇲🇾","tempat menarik":"🏞️",keluarga:"👨‍👩‍👧‍👦",kecantikan:"💄",fesyen:"👗",sukan:"⚽",permainan:"🎮",muzik:"🎵",filem:"🎥",buku:"📖",sejarah:"🏛️",sains:"🔬","alam sekitar":"🌿"};if(n[t])return n[t];for(const e in n)if(e.includes(t)||t.includes(e))return n[e];return"📝"}function m(t){if(/blogspot\.com|googleusercontent\.com/.test(t)){const n=Math.round(9*e.thumbWidth/16);return t.replace(/\/s\d+(-c)?(-[a-z]+)?\//,"/w"+e.thumbWidth+"-h"+n+"-c/")}return t}function h(t,n){if(t["media$thumbnail"]?.url)return m(t["media$thumbnail"].url);const a=(n||"").match(/<img[^>]+(?:src|data-src)=["']([^"']+)["']/i);if(a&&a[1])return m(a[1]);const s=(n||"").match(/(?:youtube\.com\/embed\/|youtu\.be\/)([A-Za-z0-9_-]{11})/);return s?"https://i.ytimg.com/vi/"+s[1]+"/hqdefault.jpg":e.fallbackThumb}function f(t,n){const a=(t||"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim();return a.length>n?a.slice(0,n).trim()+"...":a}function g(e,t){i(e+(e.includes("?")?"&":"?")+"max-results=1",(e=>{const n=parseInt(e?.feed?.["openSearch$totalResults"]?.$t||"0",10);t(n)}))}function b(e,t,a){const i=document.createElement("button");return i.className="label-btn"+(a?" all":""),i.type="button",i.textContent=e,i.setAttribute("aria-pressed",String(a)),t?s.set(t,i):s.set("ALL",i),i.addEventListener("click",(()=>{n.querySelectorAll(".label-btn").forEach((e=>{e.classList.remove("active"),e.setAttribute("aria-pressed","false")})),i.classList.add("active"),i.setAttribute("aria-pressed","true"),t?(t&&(t=t),t&&(t=t),t&&(t=t),C("label",t)):C("recent",null)})),i}function y(e){const t=s.get("ALL");t&&(t.textContent=`📋 Semua Post (${e})`)}function v(e,t){const n=s.get(e);if(n){const a=u(e);n.textContent=`${a} ${e} (${t})`}}function S(e){const t=document.createElement("nav");t.className="label-nav",t.setAttribute("role","navigation"),t.setAttribute("aria-label","Sitemap labels"),!1!==window.SitemapConfig?.showAllButton&&(()=>{const e=b("📋 Semua Post",null,!0);e.classList.add("active"),t.appendChild(e)})(),e.forEach((e=>{const n=u(e.name||e),a=e.name||e;t.appendChild(b(`${n} ${a}`,a,!1))})),n.innerHTML="",n.appendChild(t)}function L(){const n=Array.isArray(e.labelsWanted)?e.labelsWanted.filter(Boolean):[];n.length?(t.labels=n.map((e=>({name:e}))),S(t.labels),g(o(),(e=>{t.total=e,y(e)})),n.forEach((e=>g(l(e),(n=>{t.labelTotals.set(e,n),v(e,n)})))),C("recent",null,!0)):i("/feeds/posts/summary?max-results=300",(n=>{const a=n?.feed?.entry||[],s=new Map;a.forEach((e=>(e.category||[]).forEach((e=>s.set(e.term,(s.get(e.term)||0)+1)))));const c=Array.from(s.entries()).sort(((e,t)=>t[1]-e[1])).slice(0,e.labelNavLimit).map((([e,t])=>({name:e,count:t})));t.labels=c,S(c),g(o(),(e=>{t.total=e,y(e)})),c.forEach((e=>g(l(e.name),(n=>{t.labelTotals.set(e.name,n),v(e.name,n)})))),C("recent",null,!0)}))}function E(e){e?a.innerHTML='<div class="sitemap-title">📋 Menyusun pos...</div><div class="spinner" role="status" aria-label="Loading"></div>':(a.querySelector(".pagination, .actions")||{innerHTML:null}).innerHTML='<div class="spinner" role="status" aria-label="Loading"></div>'}function x(e){a.innerHTML='<div class="error"><p style="font-size:20px;margin:0 0 6px">⚠️ Ralat</p><p style="margin:0 0 10px">'+d(e||"Gagal memuatkan kandungan")+'</p><div class="actions"><button class="btn retry" type="button">Cuba semula</button></div></div>';const t=a.querySelector(".retry");t&&t.addEventListener("click",(()=>C()))}function w(){const n="recent"===t.mode,a=n?"Semua Post Terkini":t.label,s=n?t.total:t.labelTotals.get(t.label)||t.total||0;return`${u(a)} ${d(a)}${s?" ("+s+")":""}`}function P(n){const s=w(),i=t.items.map((t=>{const n=t.published?t.published.toISOString():"";return`<article class="card" itemscope itemtype="https://schema.org/BlogPosting"><a class="thumb" href="${d(t.link)}" aria-label="Baca ${d(t.title)}" rel="bookmark" itemprop="url"><img src="${d(t.thumb)}" alt="${d(t.title)}" loading="lazy" decoding="async" width="${e.thumbWidth}" height="${Math.round(9*e.thumbWidth/16)}" itemprop="image"></a><div class="content"><h3 class="title" itemprop="headline"><a href="${d(t.link)}">${d(t.title)}</a></h3>${t.excerpt?`<p class="excerpt" itemprop="description">${d(t.excerpt)}</p>`:""}<div class="meta"><time datetime="${n}" itemprop="datePublished">${p(t.published)}</time><a class="read-more" href="${d(t.link)}" aria-label="Baca lagi tentang ${d(t.title)}">Baca lagi →</a></div></div></article>`})).join(""),c="numbers"===e.pagination?(()=>{const n=Math.max(1,Math.ceil(t.total/e.perPage));return function(e){const n=t.page,a=7;let s=Math.max(1,n-Math.floor(a/2)),i=s+a-1;i>e&&(i=e,s=Math.max(1,i-a+1));const c=(e,t=e,a="")=>`<button class="page-btn ${a} ${e===n?"active":""}" data-page="${e}" type="button">${t}</button>`,l='<span class="page-btn" style="pointer-events:none;opacity:.6">…</span>';let o="";s>1&&(o+=c(1,"1"),s>2&&(o+=l));for(let t=s;t<=i;t++)o+=c(t);return i<e&&(i<e-1&&(o+=l),o+=c(e,String(e))),`<div class="pagination" role="navigation" aria-label="Pagination"><button class="page-btn prev" type="button" ${1===n?"disabled":""} aria-label="Sebelumnya">‹</button>${o}<button class="page-btn next" type="button" ${n===e?"disabled":""} aria-label="Seterusnya">›</button></div>`}(n)})():(()=>{const n=t.page*e.perPage<t.total;return`<div class="actions">${n?'<button class="btn more" type="button">Muatkan lagi</button>':""}</div>`})();a.innerHTML=`<div class="sitemap-title">${s}</div>${t.items.length?`<div class="posts-grid">${i}</div>`:'<div class="empty">Tiada pos ditemui.</div>'}${c}`,"numbers"===e.pagination?(a.querySelectorAll('.page-btn[data-page]').forEach((e=>{e.addEventListener("click",(()=>{const n=parseInt(e.getAttribute("data-page"),10);!isNaN(n)&&n!==t.page&&(t.page=n,C())}))})),a.querySelector(".page-btn.prev")?.addEventListener("click",(()=>{t.page>1&&(t.page--,C())})),a.querySelector(".page-btn.next")?.addEventListener("click",(()=>{const n=Math.max(1,Math.ceil(t.total/e.perPage));t.page<n&&(t.page++,C())}))):a.querySelector(".btn.more")?.addEventListener("click",(()=>{t.page++,C()})),a.querySelectorAll("img").forEach((t=>{t.addEventListener("error",(()=>{t.src!==e.fallbackThumb&&(t.src=e.fallbackThumb)}))}))}function k(){const e="sitemap-jsonld",n=t.items.slice(0,20),s=n.map(((e,t)=>({["@type"]:"ListItem",position:t+1,url:e.link}))),i={["@context"]:"https://schema.org",["@type"]:"CollectionPage",name:("recent"===t.mode?"Sitemap: Semua Post":"Sitemap: "+t.label)+" - The Bukit Besi Blog",url:location.href,inLanguage:document.documentElement.lang||"ms-MY",isPartOf:{["@type"]:"WebSite",url:location.origin,name:"The Bukit Besi",potentialAction:{["@type"]:"SearchAction",target:location.origin+"/search?q={search_term_string}","query-input":"required name=search_term_string"}},mainEntity:{["@type"]:"ItemList",itemListOrder:"http://schema.org/ItemListOrderAscending",numberOfItems:n.length,itemListElement:s}};let c=document.getElementById(e);c||(c=document.createElement("script"),c.type="application/ld+json",c.id=e,document.head.appendChild(c)),c.textContent=JSON.stringify(i)}function C(n,s,c){t.loading||(t.loading=!0,E(!!c),(()=>{const n=r(t.page),s="recent"===t.mode?o():l(t.label),c=`${s}?orderby=published&max-results=${e.perPage}&start-index=${n}`;i(c,(n=>{if(t.loading=!1,n){const s=n?.feed?.entry||[],i=s.map((e=>{const t=e.title?.$t||"",n=(e.link||[]).find((e=>"alternate"===e.rel))?.href||"",a=e.published?.$t?new Date(e.published.$t):null,s=e.updated?.$t?new Date(e.updated.$t):a,i=e.author?.[0]?.name?.$t||"Admin",c=e.content?.$t||e.summary?.$t||"",l=h(e,c),o=f(c,window.SitemapConfig?.excerptLength||160),r=(e.category||[]).map((e=>e.term));return{title:t,link:n,published:a,updated:s,author:i,thumb:l,excerpt:o,labels:r}})),l=parseInt(n?.feed?.["openSearch$totalResults"]?.$t||"0",10);t.total=l,"load-more"===e.pagination&&t.page>1?t.items=t.items.concat(i):t.items=i,P(),k(),c||(()=>{const e=a.getBoundingClientRect().top+window.scrollY-16;window.scrollTo({top:e,behavior:"smooth"})})()}else x("Gagal memuatkan pos. Cuba lagi.")}))})())}"label"===n?(t.mode="label",t.label=s,t.page=1,C()):(t.mode="recent",t.label=null,t.page=1,C())}L(),window.BloggerSitemap={refresh(){t.mode="recent",t.label=null,t.page=1,C(!0)}}})();