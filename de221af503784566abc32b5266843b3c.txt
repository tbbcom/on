<script>
// Auto-submit to IndexNow when new post is published
async function submitToIndexNow(url) {
  const apiKey = 'de221af503784566abc32b5266843b3c'; // Your key
  const keyLocation = 'https://tbbcom.github.io/de221af503784566abc32b5266843b3c.txt';
  
  const endpoints = [
    'https://api.indexnow.org/indexnow',
    'https://www.bing.com/indexnow',
    'https://yandex.com/indexnow',
    'https://api.seznam.cz/indexnow'
  ];
  
  const data = {
    host: 'www.thebukitbesi.com',
    key: apiKey,
    keyLocation: keyLocation,
    urlList: [url]
  };
  
  for (const endpoint of endpoints) {
    try {
      const response = await fetch(endpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });
      
      if (response.ok) {
        console.log(`Successfully submitted to ${endpoint}`);
      }
    } catch (error) {
      console.error(`Failed to submit to ${endpoint}:`, error);
    }
  }
}

// Auto-detect if this is a new post
<b:if cond='data:blog.pageType == "item"'>
  // Check if post is less than 1 hour old
  const postDate = new Date('<data:post.timestampISO8601/>');
  const now = new Date();
  const hoursSincePublish = (now - postDate) / (1000 * 60 * 60);
  
  if (hoursSincePublish < 1) {
    // This is a new post - submit it!
    submitToIndexNow('<data:post.url/>');
  }
</b:if>
</script>
